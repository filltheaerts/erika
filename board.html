<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>RH&VV Q&A â€” Q&A</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&family=Noto+Sans+KR:wght@400;500;600;700;800&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="css/style.css?v=11">
</head>
<body>

  <!-- NAV -->
  <nav class="nav" id="nav">
    <div class="container">
      <a href="home.html" class="nav-logo">RH&VV<span>.</span></a>
      <div class="nav-links" id="navLinks">
        <a href="home.html" data-i18n="nav.home">Home</a>
        <a href="board.html" class="active" data-i18n="nav.qna">Q&A</a>
        <div class="lang-toggle">
          <button data-lang="ko">KR</button>
          <button class="active" data-lang="en">EN</button>
        </div>
        <button class="btn btn-sm btn-outline nav-logout" onclick="doLogout()" data-i18n="nav.logout">Logout</button>
      </div>
      <div class="nav-hamburger" id="hamburger">
        <span></span><span></span><span></span>
      </div>
    </div>
  </nav>

  <!-- PAGE HEADER -->
  <div class="page-header">
    <div class="container">
      <p class="section-label" data-i18n="board.label">Q&A</p>
      <h1 data-i18n="board.title">Q&A</h1>
      <p data-i18n="board.desc">Leave the questions and search past answers. Resolved questions remain accessible. Admin(Erika) will check the board and answer on daily basis</p>
    </div>
  </div>

  <!-- BOARD SECTION -->
  <section class="section" style="background:var(--white); padding-top:24px;">
    <div class="container">

      <!-- Admin Bar -->
      <div class="admin-bar" id="adminBar">
        <p>
          <svg width="16" height="16" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="vertical-align:middle; margin-right:6px;"><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z" transform="scale(.67)"/></svg>
          <span data-i18n="board.admin.label">Admin Mode</span>
        </p>
      </div>

      <!-- Activity Banner -->
      <div id="newActivityBanner" class="activity-banner hidden"></div>

      <!-- Toolbar -->
      <div class="board-toolbar">
        <div class="board-filters">
          <input type="text" id="boardSearch" placeholder="Search..." data-i18n-placeholder="board.search">
          <select id="filterCategory">
            <option value="all" data-i18n="board.filter.allCat">All Categories</option>
          </select>
          <select id="filterStatus">
            <option value="all" data-i18n="board.filter.allStatus">All Status</option>
            <option value="Yes" data-i18n="board.filter.resolved">Resolved</option>
            <option value="No" data-i18n="board.filter.pending">Pending</option>
          </select>
          <input type="text" id="filterAnswerer" placeholder="Search commenter..." data-i18n-placeholder="board.filter.answerer">
        </div>
        <div class="board-actions">
          <button class="btn btn-sm btn-outline" id="cmsManageCatBtn" onclick="CMS.showEditModal('categories')" style="display:none;" data-i18n="board.manageCat">Manage Categories</button>
          <button class="btn btn-sm btn-outline" onclick="BoardApp.downloadExcel()" data-i18n="board.downloadBtn">
            <svg width="14" height="14" fill="none" stroke="currentColor" stroke-width="2" style="vertical-align:middle; margin-right:4px;"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4M7 10l5 5 5-5M12 15V3" transform="scale(.58)"/></svg>
            Download Excel
          </button>
          <button class="btn btn-sm btn-primary" onclick="BoardApp.showWriteModal()" data-i18n="board.writeBtn">Ask Question</button>
        </div>
      </div>

      <!-- Board Table -->
      <div class="board-table-wrap">
        <table class="board-table">
          <thead>
            <tr>
              <th style="width:50px">#</th>
              <th data-i18n="board.th.date">Date</th>
              <th data-i18n="board.th.from">From</th>
              <th data-i18n="board.th.category">Category</th>
              <th data-i18n="board.th.question">Question</th>
              <th data-i18n="board.th.status">Status</th>
              <th data-i18n="board.th.answeredBy">Commented by</th>
            </tr>
          </thead>
          <tbody id="boardTableBody"></tbody>
        </table>
      </div>

      <!-- Empty State -->
      <div class="empty-state hidden" id="boardEmpty">
        <svg viewBox="0 0 64 64" fill="none" stroke="currentColor" stroke-width="2">
          <rect x="8" y="8" width="48" height="48" rx="8"/>
          <line x1="20" y1="24" x2="44" y2="24"/>
          <line x1="20" y1="32" x2="36" y2="32"/>
          <line x1="20" y1="40" x2="40" y2="40"/>
        </svg>
        <p data-i18n="board.empty">No posts found.</p>
      </div>

      <!-- Pagination -->
      <div class="board-pagination" id="boardPagination"></div>
    </div>
  </section>

  <!-- WRITE MODAL -->
  <div class="modal-overlay" id="writeModal">
    <div class="modal">
      <div class="modal-header">
        <h3 data-i18n="board.write.title">New Question</h3>
        <button class="modal-close" onclick="BoardApp.closeModals()">&times;</button>
      </div>
      <div class="modal-body">
        <form id="writeForm" onsubmit="BoardApp.submitQuestion(event)">
          <div class="form-row">
            <div class="form-group">
              <label data-i18n="board.write.name">Name (Nickname)</label>
              <input type="text" id="writeFrom" required maxlength="50">
            </div>
            <div class="form-group">
              <label data-i18n="board.write.category">Category</label>
              <select id="writeCategory" required></select>
            </div>
          </div>
          <div class="form-group">
            <label data-i18n="board.write.question">Question</label>
            <textarea id="writeQuestion" required maxlength="2000" placeholder="Write your question here..." data-i18n-placeholder="board.write.qPlaceholder"></textarea>
          </div>
          <p style="font-size:.8rem; color:var(--text-muted); margin-bottom:16px;" data-i18n="board.write.notice">* Please check existing answers before posting duplicate questions.</p>
          <button type="submit" class="btn btn-primary" style="width:100%;" data-i18n="board.write.submit">Submit Question</button>
        </form>
      </div>
    </div>
  </div>

  <!-- DETAIL MODAL -->
  <div class="modal-overlay" id="detailModal">
    <div class="modal">
      <div class="modal-header">
        <h3 data-i18n="board.detail.title">Question Detail</h3>
        <button class="modal-close" onclick="BoardApp.closeModals()">&times;</button>
      </div>
      <div class="modal-body" id="detailContent"></div>
    </div>
  </div>

  <!-- EDIT MODAL -->
  <div class="modal-overlay" id="editModal">
    <div class="modal">
      <div class="modal-header">
        <h3 data-i18n="board.edit.title">Edit Question</h3>
        <button class="modal-close" onclick="BoardApp.closeModals()">&times;</button>
      </div>
      <div class="modal-body">
        <form id="editForm" onsubmit="BoardApp.submitEdit(event)">
          <input type="hidden" id="editPostId">
          <div class="form-group">
            <label data-i18n="board.edit.category">Category</label>
            <select id="editCategory" required></select>
          </div>
          <div class="form-group">
            <label data-i18n="board.edit.question">Question</label>
            <textarea id="editQuestion" required maxlength="2000" placeholder="Edit your question..." data-i18n-placeholder="board.edit.qPlaceholder"></textarea>
          </div>
          <button type="submit" class="btn btn-primary" style="width:100%;" data-i18n="board.edit.submit">Save Changes</button>
        </form>
      </div>
    </div>
  </div>

  <!-- FOOTER -->
  <footer class="footer">
    <div class="container">
      <p>&copy; 2026 RH&VV Q&A. All rights reserved.</p>
      <div class="footer-links">
        <a href="home.html">Home</a>
        <a href="board.html">Q&A</a>
      </div>
    </div>
  </footer>

  <!-- CMS Edit Modal -->
  <div class="modal-overlay" id="cmsEditModal">
    <div class="modal">
      <div class="modal-header">
        <h3 id="cmsEditTitle">Edit</h3>
        <button class="modal-close" onclick="CMS.closeCmsModal()">&times;</button>
      </div>
      <div class="modal-body" id="cmsEditBody"></div>
    </div>
  </div>

  <!-- Firebase SDK -->
  <script src="https://www.gstatic.com/firebasejs/12.9.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/12.9.0/firebase-firestore-compat.js"></script>
  <script src="js/firebase-config.js?v=11"></script>
  <script src="js/main.js?v=11"></script>
  <script src="js/board.js?v=11"></script>
  <script src="js/cms.js?v=11"></script>
  <script>
    document.addEventListener('DOMContentLoaded', async () => {
      await CMS.init();
      CMS.renderCategoryOptions();
      await BoardApp.init();
    });
  </script>
</body>
</html>
